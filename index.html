<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokémon Stats Comparator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .input-group {
            display: flex;
            justify-content: space-around;
            gap: 20px;
        }

        .stats-form {
            flex: 1;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .stats-form h3 {
            text-align: center;
            margin-top: 0;
        }

        .stat-input {
            margin-bottom: 10px;
        }

        .stat-input label {
            display: block;
            font-weight: bold;
        }

        .stat-input input, .stat-input select {
            width: 100%;
            padding: 5px;
            box-sizing: border-box;
        }

        .results {
            margin-top: 20px;
        }

        .stat-bar-container {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .stat-name {
            width: 80px;
            font-weight: bold;
            text-align: right;
            margin-right: 20px;
        }

        .stat-value {
            width: 40px;
            text-align: left;
            margin-right: 10px;
        }

        .stat-bar {
            flex-grow: 1;
            height: 20px;
            border-radius: 3px;
            background-color: #eee;
            position: relative;
            overflow: hidden;
        }

        .stat-bar-fill {
            height: 100%;
            transition: width 0.5s ease-in-out, background-color 0.5s ease-in-out;
            position: absolute;
            left: 0;
            top: 0;
        }

        .comparison-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 20px;
        }

        .comparison-bar-container {
            width: 45%;
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .comparison-bar-container.p2 {
            flex-direction: row-reverse;
            text-align: right;
        }

        .comparison-bar-container .stat-value, .comparison-bar-container .stat-name {
            width: auto;
            margin-right: 0;
        }

        .comparison-bar-container .stat-name {
            width: 70px;
            text-align: left;
            margin-right: 20px;
        }
        
        .comparison-bar-container.p2 .stat-name {
            text-align: right;
        }

        .middle-comparison {
            width: 10%;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
        }

        .total-stats {
            text-align: center;
            font-weight: bold;
            margin-top: 10px;
        }

        .button-group {
            text-align: center;
            margin-top: 20px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }

        #poke2-form {
            display: none;
        }

        .pokemon-selector {
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Pokémon Stats Comparator</h1>
        <div class="input-group">
            <div class="stats-form">
                <h3>Pokémon 1</h3>
                <div class="pokemon-selector">
                    <label for="p1-pokemon-select">Select a Pokémon:</label>
                    <select id="p1-pokemon-select" onchange="loadPokemonStats(this.value, 'p1')"></select>
                </div>
                <form id="poke1-form">
                    <div class="stat-input">
                        <label for="p1-hp">HP:</label>
                        <input type="number" id="p1-hp" min="1" max="255" required>
                    </div>
                    <div class="stat-input">
                        <label for="p1-attack">Attack:</label>
                        <input type="number" id="p1-attack" min="1" max="255" required>
                    </div>
                    <div class="stat-input">
                        <label for="p1-defense">Defense:</label>
                        <input type="number" id="p1-defense" min="1" max="255" required>
                    </div>
                    <div class="stat-input">
                        <label for="p1-sp-attack">Sp. Atk:</label>
                        <input type="number" id="p1-sp-attack" min="1" max="255" required>
                    </div>
                    <div class="stat-input">
                        <label for="p1-sp-defense">Sp. Def:</label>
                        <input type="number" id="p1-sp-defense" min="1" max="255" required>
                    </div>
                    <div class="stat-input">
                        <label for="p1-speed">Speed:</label>
                        <input type="number" id="p1-speed" min="1" max="255" required>
                    </div>
                </form>
            </div>
            <div class="stats-form" id="poke2-form">
                <h3>Pokémon 2</h3>
                <div class="pokemon-selector">
                    <label for="p2-pokemon-select">Select a Pokémon:</label>
                    <select id="p2-pokemon-select" onchange="loadPokemonStats(this.value, 'p2')"></select>
                </div>
                <form id="poke2-subform">
                    <div class="stat-input">
                        <label for="p2-hp">HP:</label>
                        <input type="number" id="p2-hp" min="1" max="255">
                    </div>
                    <div class="stat-input">
                        <label for="p2-attack">Attack:</label>
                        <input type="number" id="p2-attack" min="1" max="255">
                    </div>
                    <div class="stat-input">
                        <label for="p2-defense">Defense:</label>
                        <input type="number" id="p2-defense" min="1" max="255">
                    </div>
                    <div class="stat-input">
                        <label for="p2-sp-attack">Sp. Atk:</label>
                        <input type="number" id="p2-sp-attack" min="1" max="255">
                    </div>
                    <div class="stat-input">
                        <label for="p2-sp-defense">Sp. Def:</label>
                        <input type="number" id="p2-sp-defense" min="1" max="255">
                    </div>
                    <div class="stat-input">
                        <label for="p2-speed">Speed:</label>
                        <input type="number" id="p2-speed" min="1" max="255">
                    </div>
                </form>
            </div>
        </div>
        <div class="button-group">
            <button onclick="calculateAndDisplayStats()">Show Stats</button>
            <button id="mode-button" onclick="toggleComparisonMode()">Compare 2 Pokémon</button>
        </div>
        
        <div id="results-section" class="results" style="display:none;">
            <hr>
            <h2>Results</h2>
            <div id="single-result"></div>
            <div id="comparison-result" style="display:none;"></div>
        </div>
    </div>

    <script>
        const statNames = ['HP', 'Attack', 'Defense', 'Sp. Atk', 'Sp. Def', 'Speed'];
        let isComparisonMode = false;
        
        document.addEventListener('DOMContentLoaded', () => {
            fetchPokemonList();
        });

        async function fetchPokemonList() {
            try {
                // Fetch the main list of all Pokémon (species)
                const speciesResponse = await fetch('https://pokeapi.co/api/v2/pokemon-species?limit=10000');
                const speciesData = await speciesResponse.json();

                // Fetch a list of all Pokémon (forms) to get URLs for mega evolutions, etc.
                const formsResponse = await fetch('https://pokeapi.co/api/v2/pokemon?limit=10000');
                const formsData = await formsResponse.json();

                const allPokemonMap = new Map();

                // Use the species list as the base and add to the map
                speciesData.results.forEach(p => {
                    allPokemonMap.set(p.name, p);
                });

                // Add special forms and mega evolutions to the map
                formsData.results.forEach(p => {
                    const name = p.name;
                    // Simple logic to include popular forms without duplicates
                    if (name.includes('-mega') || name.includes('-gmax') || name.includes('-alola') || name.includes('-galar') || name.includes('-hisui') || name.includes('-paldea')) {
                        allPokemonMap.set(name, p);
                    }
                });

                const allPokemon = Array.from(allPokemonMap.values()).sort((a, b) => {
                    const aName = a.name.toLowerCase();
                    const bName = b.name.toLowerCase();
                    if (aName < bName) return -1;
                    if (aName > bName) return 1;
                    return 0;
                });
                
                const select1 = document.getElementById('p1-pokemon-select');
                const select2 = document.getElementById('p2-pokemon-select');

                const defaultOption = document.createElement('option');
                defaultOption.value = '';
                defaultOption.textContent = 'Select a Pokémon...';
                select1.appendChild(defaultOption.cloneNode(true));
                select2.appendChild(defaultOption.cloneNode(true));

                allPokemon.forEach(pokemon => {
                    const option = document.createElement('option');
                    option.value = pokemon.name;
                    option.textContent = pokemon.name.charAt(0).toUpperCase() + pokemon.name.slice(1).replace(/-/g, ' ');
                    select1.appendChild(option.cloneNode(true));
                    select2.appendChild(option);
                });
            } catch (error) {
                console.error('Error fetching Pokémon list:', error);
            }
        }

        async function loadPokemonStats(pokemonName, prefix) {
            if (!pokemonName) return;
            try {
                const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${pokemonName}`);
                const data = await response.json();
                
                document.getElementById(`${prefix}-hp`).value = data.stats[0].base_stat;
                document.getElementById(`${prefix}-attack`).value = data.stats[1].base_stat;
                document.getElementById(`${prefix}-defense`).value = data.stats[2].base_stat;
                document.getElementById(`${prefix}-sp-attack`).value = data.stats[3].base_stat;
                document.getElementById(`${prefix}-sp-defense`).value = data.stats[4].base_stat;
                document.getElementById(`${prefix}-speed`).value = data.stats[5].base_stat;

                calculateAndDisplayStats();
            } catch (error) {
                console.error(`Error fetching stats for ${pokemonName}:`, error);
            }
        }

        function getColor(stat) {
            const minStat = 1;
            const maxStat = 255;
            const hue = Math.min(240, Math.max(0, (stat - minStat) / (maxStat - minStat) * 240));
            return `hsl(${hue}, 80%, 50%)`;
        }

        function createStatBar(name, value, containerId, isComparison = false, isP2 = false) {
            const container = document.getElementById(containerId);
            const barContainer = document.createElement('div');
            barContainer.classList.add('stat-bar-container');
            if (isComparison && isP2) {
                barContainer.classList.add('p2');
            }

            const statName = document.createElement('div');
            statName.classList.add('stat-name');
            statName.textContent = name;
            
            const statValue = document.createElement('div');
            statValue.classList.add('stat-value');
            statValue.textContent = value;
            
            const statBar = document.createElement('div');
            statBar.classList.add('stat-bar');
            
            const statFill = document.createElement('div');
            statFill.classList.add('stat-bar-fill');
            statFill.style.width = `${Math.min(100, (value / 255) * 100)}%`;
            statFill.style.backgroundColor = getColor(value);
            
            statBar.appendChild(statFill);

            if (isP2) {
                barContainer.appendChild(statValue);
                barContainer.appendChild(statName);
                barContainer.appendChild(statBar);
            } else {
                barContainer.appendChild(statName);
                barContainer.appendChild(statValue);
                barContainer.appendChild(statBar);
            }
            container.appendChild(barContainer);
        }

        function calculateAndDisplayStats() {
            const stats1 = getStats('p1');
            const stats2 = getStats('p2');
            
            const resultsSection = document.getElementById('results-section');
            resultsSection.style.display = 'block';

            const singleResult = document.getElementById('single-result');
            const comparisonResult = document.getElementById('comparison-result');
            
            singleResult.innerHTML = '';
            comparisonResult.innerHTML = '';

            if (!isComparisonMode || stats2.every(s => s === null)) {
                document.getElementById('comparison-result').style.display = 'none';
                document.getElementById('single-result').style.display = 'block';
                statNames.forEach((name, i) => {
                    createStatBar(name, stats1[i], 'single-result');
                });
                const bst1 = stats1.reduce((a, b) => a + b, 0);
                const bstElement = document.createElement('div');
                bstElement.classList.add('total-stats');
                bstElement.textContent = `Base Stat Total: ${bst1}`;
                singleResult.appendChild(bstElement);
            } else {
                document.getElementById('single-result').style.display = 'none';
                document.getElementById('comparison-result').style.display = 'block';
                
                const bst1 = stats1.reduce((a, b) => a + b, 0);
                const bst2 = stats2.reduce((a, b) => a + b, 0);
                
                const winnerClass = (value1, value2) => {
                    if (value1 > value2) return 'pokemon1-winner';
                    if (value2 > value1) return 'pokemon2-winner';
                    return 'draw';
                };
                
                statNames.forEach((name, i) => {
                    const stat1 = stats1[i];
                    const stat2 = stats2[i];
                    const comparisonRow = document.createElement('div');
                    comparisonRow.classList.add('comparison-section');
                    
                    const p1BarContainer = document.createElement('div');
                    p1BarContainer.classList.add('comparison-bar-container', 'p1');
                    
                    const p1Name = document.createElement('div');
                    p1Name.classList.add('stat-name');
                    p1Name.textContent = name;
                    
                    const p1Value = document.createElement('div');
                    p1Value.classList.add('stat-value');
                    p1Value.textContent = stat1;
                    
                    const p1Bar = document.createElement('div');
                    p1Bar.classList.add('stat-bar');
                    const p1Fill = document.createElement('div');
                    p1Fill.classList.add('stat-bar-fill');
                    p1Fill.style.width = `${Math.min(100, (stat1 / 255) * 100)}%`;
                    p1Fill.style.backgroundColor = getColor(stat1);
                    p1Bar.appendChild(p1Fill);
                    
                    p1BarContainer.appendChild(p1Name);
                    p1BarContainer.appendChild(p1Value);
                    p1BarContainer.appendChild(p1Bar);
                    
                    const middleComparison = document.createElement('div');
                    middleComparison.classList.add('middle-comparison');
                    const diff = stat1 - stat2;
                    middleComparison.innerHTML = `(${diff > 0 ? '+' : ''}${diff}) <br> ${winnerClass(stat1, stat2) === 'pokemon1-winner' ? '➡️' : (winnerClass(stat1, stat2) === 'pokemon2-winner' ? '⬅️' : '🤝')}`;
                    
                    const p2BarContainer = document.createElement('div');
                    p2BarContainer.classList.add('comparison-bar-container', 'p2');
                    
                    const p2Name = document.createElement('div');
                    p2Name.classList.add('stat-name');
                    p2Name.textContent = name;
                    
                    const p2Value = document.createElement('div');
                    p2Value.classList.add('stat-value');
                    p2Value.textContent = stat2;
                    
                    const p2Bar = document.createElement('div');
                    p2Bar.classList.add('stat-bar');
                    const p2Fill = document.createElement('div');
                    p2Fill.classList.add('stat-bar-fill');
                    p2Fill.style.width = `${Math.min(100, (stat2 / 255) * 100)}%`;
                    p2Fill.style.backgroundColor = getColor(stat2);
                    p2Bar.appendChild(p2Fill);
                    
                    p2BarContainer.appendChild(p2Bar);
                    p2BarContainer.appendChild(p2Value);
                    p2BarContainer.appendChild(p2Name);
                    
                    comparisonRow.appendChild(p1BarContainer);
                    comparisonRow.appendChild(middleComparison);
                    comparisonRow.appendChild(p2BarContainer);
                    
                    comparisonResult.appendChild(comparisonRow);
                });
                
                const bstComparison = document.createElement('div');
                bstComparison.classList.add('comparison-section');
                
                const bst1Container = document.createElement('div');
                bst1Container.classList.add('comparison-bar-container', 'p1');
                const bst1Name = document.createElement('div');
                bst1Name.classList.add('stat-name');
                bst1Name.textContent = 'BST';
                const bst1Value = document.createElement('div');
                bst1Value.classList.add('stat-value');
                bst1Value.textContent = bst1;
                bst1Container.appendChild(bst1Name);
                bst1Container.appendChild(bst1Value);
                
                const bstMiddle = document.createElement('div');
                bstMiddle.classList.add('middle-comparison');
                const bstDiff = bst1 - bst2;
                bstMiddle.innerHTML = `(${bstDiff > 0 ? '+' : ''}${bstDiff}) <br> ${winnerClass(bst1, bst2) === 'pokemon1-winner' ? '➡️' : (winnerClass(bst1, bst2) === 'pokemon2-winner' ? '⬅️' : '🤝')}`;
                
                const bst2Container = document.createElement('div');
                bst2Container.classList.add('comparison-bar-container', 'p2');
                const bst2Name = document.createElement('div');
                bst2Name.classList.add('stat-name');
                bst2Name.textContent = 'BST';
                const bst2Value = document.createElement('div');
                bst2Value.classList.add('stat-value');
                bst2Value.textContent = bst2;
                bst2Container.appendChild(bst2Name);
                bst2Container.appendChild(bst2Value);
                
                bstComparison.appendChild(bst1Container);
                bstComparison.appendChild(bstMiddle);
                bstComparison.appendChild(bst2Container);
                
                comparisonResult.appendChild(bstComparison);
            }
        }

        function getStats(prefix) {
            const stats = ['hp', 'attack', 'defense', 'sp-attack', 'sp-defense', 'speed'];
            return stats.map(stat => {
                const input = document.getElementById(`${prefix}-${stat}`);
                return input && input.value ? parseInt(input.value) : null;
            });
        }

        function toggleComparisonMode() {
            isComparisonMode = !isComparisonMode;
            const form2 = document.getElementById('poke2-form');
            const modeButton = document.getElementById('mode-button');

            if (isComparisonMode) {
                form2.style.display = 'block';
                modeButton.textContent = 'Change to Single Pokémon Mode';
            } else {
                form2.style.display = 'none';
                modeButton.textContent = 'Compare 2 Pokémon';
                document.getElementById('comparison-result').style.display = 'none';
                document.getElementById('single-result').style.display = 'none';
            }
        }
    </script>
</body>
</html>
